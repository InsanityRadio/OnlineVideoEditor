(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{196:function(e,t,a){e.exports=a(459)},201:function(e,t,a){},203:function(e,t,a){},205:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},459:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(27),s=a.n(r),o=(a(201),a(4)),l=a(5),c=a(6),u=a(3),h=a(7),d=a(464),m=a(463),p=(a(203),a(205),a(206),function(){function e(){Object(o.a)(this,e)}return Object(l.a)(e,[{key:"fetch",value:function(e){function t(t,a,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t,a){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/api";void 0!=t&&(e+="?"+new URLSearchParams(t).toString());return a||(a={}),a.credentials="same-origin",a.headers||(a.headers={}),a.headers["X-Requested-With"]="XMLHttpRequest",fetch(i+e,a).then(function(e){return n.checkResponse(e)}).then(function(e){return e.json()})})},{key:"checkResponse",value:function(e){return e.status>=500&&console.error("Backend returned "+e.status),e}},{key:"fetchWithForm",value:function(e,t,a,n){var i=new FormData;Object.keys(a).forEach(function(e){return i.append(e,a[e])});var r={method:"POST",body:i};return Object.assign(r,n||{}),this.fetch(e,t,r)}},{key:"fetchWithFile",value:function(e,t,a,n){return this.fetchWithForm(e,t,{file:a},n)}}]),e}()),v=a(67),f=function(){function e(t){Object(o.a)(this,e),t&&this.initialize(t)}return Object(l.a)(e,[{key:"initialize",value:function(e){for(var t in e)this["_"+t]=e[t]}},{key:"get",value:function(e){var t=this["a_"+e],a=this["b_"+e];return t?this["_"+e].map(function(e){return new t(e,a)}):this["_"+e]}},{key:"set",value:function(e,t){return this["_"+e]=t,this}},{key:"attr_reader",value:function(e,t,a,n){a&&t?(this["a_"+e]=t,this["b_"+e]=n,Object.defineProperty(this,e,{get:function(){return this.get(e)}.bind(this)})):Object.defineProperty(this,e,{get:function(){return t?new t(this.get(e)):this.get(e)}.bind(this)})}}]),e}(),g=function(e){function t(e,a){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).attr_reader("id"),n.attr_reader("name"),n.attr_reader("configuration"),n.attr_reader("platform_type"),n.attr_reader("default_share_text"),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"icon",get:function(){return{facebook:["fab","facebook-f"],instagram:["fab","instagram"],twitter:["fab","twitter"],youtube:["fab","youtube"]}[this.platform_type]||this.platform_type}}]),t}(f),y=function(e){function t(e,a){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).attr_reader("id"),n.attr_reader("platform",g),n.attr_reader("configuration"),n.attr_reader("title"),n.attr_reader("description"),n.attr_reader("publish_on"),n.attr_reader("shared"),n}return Object(h.a)(t,e),t}(f),b=function(e){function t(e,a){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).attr_reader("id"),n.attr_reader("created_by"),n.attr_reader("type"),n.attr_reader("configuration"),n.attr_reader("queued"),n.attr_reader("rendered"),n.attr_reader("shares",y,!0),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"getDownloadPath",value:function(){return this.getBasePath()+"/download.mp4"}},{key:"getBasePath",value:function(){return"/api/import/todo/video/"+this.id}}]),t}(f),k=function(e){function t(e,a){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).attr_reader("uuid"),n.attr_reader("title"),n.attr_reader("videos",b,!0),n.attr_reader("created_by"),n}return Object(h.a)(t,e),t}(f),w=function(e){function t(e,a){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).attr_reader("id"),n.attr_reader("name"),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"getThumbnailPath",value:function(){return this.getBasePath()+"/thumbnail.jpg"}},{key:"getPath",value:function(){return this.getBasePath()+"/download.mp4"}},{key:"getBasePath",value:function(){return"/api/slates/"+this.id}}]),t}(f),E=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"fetch",value:function(e,a,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return Object(v.a)(Object(u.a)(t.prototype),"fetch",this).call(this,i+e,a,n)}},{key:"bootstrap",value:function(){var e=this;return this.fetch("/bootstrap").then(function(t){e.setCSRFToken(t.csrf_token),e.setServices(t.services)})}},{key:"setCSRFToken",value:function(e){this.csrfToken=e}},{key:"setServices",value:function(e){this.services=e}},{key:"getServices",value:function(){return this.services}},{key:"loadImports",value:function(){return this.fetch("/_/imports").then(function(e){if(1!=e.success)throw new Error("Failed to load a list of imports from the server!");return e.imports.map(function(e){return new k(e)})})}},{key:"findImportByID",value:function(e){return this.fetch("/_/imports").then(function(t){if(1!=t.success)throw new Error("Failed to load a list of imports from the server!");var a=t.imports.find(function(t){return t.uuid==e});if(!a)throw new Error("Could not find import on backend");return new k(a)})}},{key:"takeOwnership",value:function(e,t,a){var n=this;return this.fetchWithForm("/_/import/new",{},{service:e,title:a,uuid:t}).then(function(e){return n.createImportObj(e)})}},{key:"deleteImport",value:function(e,t){return this.fetchWithForm("/_/import/"+t+"/delete",{},{}).then(function(e){return e.success})}},{key:"updateVideo",value:function(e,t,a){var n=this;return this.fetchWithForm("/import/"+e+"/"+t+"/save",{},{configuration:a}).then(function(e){return n.createImportObj(e)})}},{key:"createVideoByType",value:function(e,t){var a=this;return this.fetchWithForm("/import/"+e+"/create_video",{type:t},{}).then(function(e){return a.createImportObj(e)})}},{key:"deleteVideoById",value:function(e,t){var a=this;return this.fetchWithForm("/import/"+e+"/"+t+"/delete",{},{}).then(function(e){return a.createImportObj(e)})}},{key:"loadRenderState",value:function(e){return this.fetch("/import/"+e+"/render").then(function(e){if(1!=e.success)throw new Error("Failed to load render states for given import");return e.renders})}},{key:"renderVideo",value:function(e,t){var a=this;return this.fetchWithForm("/import/"+e+"/"+t+"/render",{},{}).then(function(e){return a.createImportObj(e)})}},{key:"createImportObj",value:function(e){if(1!=e.success)throw new Error("Failed to load a list of imports from the server!");var t=e.import;if(!t)throw new Error("Could not find import on backend");return new k(t)}},{key:"createSlateObj",value:function(e){if(1!=e.success)throw new Error("Failed to load slate");var t=e.slate;if(!t)throw new Error("Could not load slate from backend");return new w(t)}},{key:"createPlatformObj",value:function(e){if(1!=e.success)throw new Error("Failed to load slate");var t=e.platform;return new g(t)}},{key:"loadSlates",value:function(){return this.fetch("/slates/").then(function(e){if(!e.success)throw new Error("Failed to load list of slates from server");return e.slates.map(function(e){return new w(e)})})}},{key:"uploadSlate",value:function(e,t,a){var n=this;return this.fetchWithFile("/slates/new",{name:e,cue_point:a},t).then(function(e){return n.createSlateObj(e)})}},{key:"deleteSlate",value:function(e){return this.fetchWithForm("/slates/delete",{id:e},{})}},{key:"loadPlatforms",value:function(){return this.fetch("/platform/").then(function(e){if(!e.success)throw new Error("Failed to load list of platforms from server");return e.platforms.map(function(e){return new g(e)})})}},{key:"createPlatform",value:function(e,t,a){var n=this;return this.fetchWithForm("/platform/new",{},{name:t,platform_type:e,configuration:a}).then(function(e){return n.createPlatformObj(e)})}},{key:"updatePlatform",value:function(e,t,a){var n=this;return this.fetchWithForm("/platform/"+e+"/save",{},{name:t,configuration:a}).then(function(e){return n.createPlatformObj(e)})}},{key:"deletePlatform",value:function(e){return this.fetchWithForm("/platform/"+e+"/delete",{id:e},{})}},{key:"createShare",value:function(e,t,a,n,i,r){var s=this;return this.fetchWithForm("/import/"+e+"/"+t+"/share/new",{},{platform_id:a,title:n,description:i,configuration:r}).then(function(e){return s.createImportObj(e)})}},{key:"updateShare",value:function(e,t,a,n,i,r){var s=this;return this.fetchWithForm("/import/"+e+"/"+t+"/share/"+a+"/save",{},{title:n,description:i,configuration:r}).then(function(e){return s.createImportObj(e)})}},{key:"deleteShare",value:function(e,t,a){var n=this;return this.fetchWithForm("/import/"+e+"/"+t+"/share/"+a+"/delete",{},{}).then(function(e){return n.createImportObj(e)})}},{key:"publishShare",value:function(e,t,a){return this.fetchWithForm("/import/"+e+"/"+t+"/share/"+a+"/now",{},{}).then(function(e){return 1==e.success})}}]),t}(p),S=function(e){function t(e,a){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).attr_reader("service"),n.attr_reader("start_time"),n.attr_reader("end_time"),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"getThumbnailPath",value:function(){return"/api/ingest/"+this.get("service")+"/thumbnail.jpg?time="+(this.get("start_time")+5)}}]),t}(f),O=function(e){function t(e,a){var n;return Object(o.a)(this,t),e.service_name=a,(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).attr_reader("uuid"),n.attr_reader("start_time"),n.attr_reader("end_time"),n.attr_reader("real_start_time"),n.attr_reader("real_end_time"),n.attr_reader("length"),n.attr_reader("start_offset"),n.attr_reader("expiry"),n.attr_reader("service_name"),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"getPreviewPath",value:function(){return this.getBasePath()+"/preview.m3u8"}},{key:"getDownloadPath",value:function(){return this.getBasePath()+"/download.mp4"}},{key:"getThumbnailPath",value:function(){return this.getBasePath()+"/preview.jpg"}},{key:"getBasePath",value:function(){return"/api/ingest/"+this.service_name+"/import/"+this.uuid}}]),t}(f),C=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"fetch",value:function(e,a,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/ingest";return Object(v.a)(Object(u.a)(t.prototype),"fetch",this).call(this,i+e,a,n)}},{key:"bootstrap",value:function(){var e=this;return this.fetch("/bootstrap").then(function(t){e.setCSRFToken(t.csrf_token),e.setServices(t.services)})}},{key:"setCSRFToken",value:function(e){this.csrfToken=e}},{key:"setServices",value:function(e){this.services=e}},{key:"getServices",value:function(){return this.services}},{key:"importVideo",value:function(e,t,a){var n={start_time:t,end_time:a};return this.fetchWithForm("/"+e+"/import",void 0,n).then(function(t){if(1!=t.success)throw new Error("Import failed");return new O(t.data,e)})}},{key:"findImports",value:function(e){return this.fetch("/"+e+"/imports").then(function(t){if(1!=t.success)throw new Error("Failed to load a list of imports from the server!");return t.imports.map(function(t){return new O(t,e)})})}},{key:"findImportByID",value:function(e,t){return this.fetch("/"+e+"/import/"+t).then(function(t){if(1!=t.success)throw new Error("Failed to load a list of imports from the server!");return new O(t.import,e)})}},{key:"deleteImportByID",value:function(e,t){return this.fetchWithForm("/"+e+"/import/"+t+"/delete",{},{}).then(function(e){if(1!=e.success)throw new Error("Failed to delete import "+t);return!0})}},{key:"loadCuePoints",value:function(e){return this.fetch("/"+e+"/cue_points").then(function(e){if(1!=e.success)throw new Error("Failed to load list of cue points from the server!");return e.points.map(function(e){return new S(e)})})}}]),t}(p),j=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).airtowers=[],e}return Object(h.a)(t,e),Object(l.a)(t,null,[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}},{key:"register",value:function(e,a){t.getInstance().register(e,a)}}]),Object(l.a)(t,[{key:"register",value:function(e,t){var a=new t;this.airtowers.push(a),this[e]=a}},{key:"bootstrap",value:function(){return Promise.all(this.airtowers.map(function(e){return e.bootstrap()})).catch(function(e){return!1})}}]),t}(p);j.register("ingest",C),j.register("core",E);var P=a(23),_=a(8),T=a.n(_),x=a(78),I=a.n(x),F=a(35),N=a.n(F),V=a(131),D=a.n(V),W=a(29),R=a.n(W),M=a(31),B=a.n(M),A=a(37),L=a.n(A),U=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={connected:!1,facebookPageID:0,facebookPages:[],visiblePages:[]},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){if(!window.FB){var e=window.fbAsyncInit;window.fbAsyncInit=function(){e(),this.facebookReady()}}this.facebookReady()}},{key:"facebookReady",value:function(){window.FB.getLoginStatus(function(e){})}},{key:"facebookLogin",value:function(){var e=this;window.FB.login(function(t){"connected"==t.status&&e.setState({connected:!0},function(){return e.findPages()})},{auth_type:"reauthenticate",scope:["instagram_basic","manage_pages","publish_pages"]})}},{key:"findPages",value:function(){var e=this;return new Promise(function(t,a){window.FB.api("/me/accounts",function(t){e.setState({facebookPages:t.data})})})}},{key:"findInstagramPages",value:function(){var e=this,t=[];this.state.facebookPages.forEach(function(a){window.FB.api("/"+a.id+"?fields=instagram_business_account",function(n){null!=n.instagram_business_account&&(t.push(a),e.setState({visiblePages:t}))})})}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return i.a.createElement("div",{style:{width:"100%"}},this.state.connected?this.renderPageSelection():this.renderAuthentication())}},{key:"updateLocalField",value:function(e,t){this.setState(Object(P.a)({},e,t.target[t.target.hasOwnProperty("checked")?"checked":"value"]))}},{key:"connectPage",value:function(){var e=this.state.facebookPageID,t=this.state.facebookPages.find(function(t){return t.id==e});if(!t)throw new Error("User selected ");var a=t.access_token,n=t.name,i={page_id:e,user_access_token:window.FB.getAuthResponse().accessToken,page_access_token:a};this.props.createPlatform("facebook",n,i)}},{key:"renderPageSelection",value:function(){return i.a.createElement("div",{style:{width:"100%"}},i.a.createElement(B.a,{variant:"outlined",fullWidth:!0},i.a.createElement(L.a,{fullWidth:!0,value:this.state.facebookPageID,variant:"outlined",onChange:this.updateLocalField.bind(this,"facebookPageID"),input:i.a.createElement(N.a,{fullWidth:!0})},this.state.facebookPages.map(function(e){return i.a.createElement(R.a,{value:e.id},e.name)}))),i.a.createElement(I.a,null),i.a.createElement(D.a,null,i.a.createElement(T.a,{onClick:this.connectPage.bind(this)},this.props.instagram?"Link Instagram":"Connect Page")))}},{key:"renderAuthentication",value:function(){return i.a.createElement(T.a,{variant:"outlined",onClick:this.facebookLogin.bind(this)},"Authorize Account")}}]),t}(n.Component),H=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={connected:!1,facebookPageID:0,facebookPages:[],instagramPageID:0,visiblePages:[]},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"findPages",value:function(){var e=this;return new Promise(function(t,a){window.FB.api("/me/accounts",function(t){e.setState({facebookPages:t.data},function(){return e.findInstagramPages()})})})}},{key:"findInstagramPages",value:function(){var e=this,t=[];this.state.facebookPages.forEach(function(a){window.FB.api("/"+a.id+"?fields=instagram_business_account",function(n){null!=n.instagram_business_account&&(a.instagram_page_id=n.instagram_business_account.id,t.push(a),e.setState({visiblePages:t}))})})}},{key:"connectPage",value:function(){var e=this.state.instagramPageID,t=this.state.visiblePages.find(function(t){return t.id==e});if(!t)throw new Error("User selected ");var a=t.access_token,n=t.name,i={page_id:e,instagram_page_id:t.instagram_page_id,access_token:a};this.props.createPlatform("instagram",n,i)}},{key:"renderPageSelection",value:function(){return i.a.createElement("div",null,i.a.createElement(B.a,{variant:"outlined",fullWidth:!0},i.a.createElement(L.a,{fullWidth:!0,value:this.state.instagramPageID,variant:"outlined",onChange:this.updateLocalField.bind(this,"instagramPageID"),input:i.a.createElement(N.a,{fullWidth:!0})},this.state.visiblePages.map(function(e){return i.a.createElement(R.a,{value:e.id},e.name)}))),i.a.createElement(T.a,{variant:"outlined",onClick:this.connectPage.bind(this)},"Link Instagram"))}}]),t}(U),z=a(52),X=a.n(z),q=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={platforms:[]},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this;j.getInstance().core.loadPlatforms().then(function(t){return e.setState({platforms:t})})}},{key:"selectPlatform",value:function(e){this.setState({platform:e})}},{key:"createPlatform",value:function(e,t,a){var n=this;j.getInstance().core.createPlatform(e,t,JSON.stringify(a)).then(function(e){return n.props.change()})}},{key:"render",value:function(){return this.props.embedded?this.renderBody():i.a.createElement("div",{className:"fullpage home one-page"},i.a.createElement(X.a,{className:"platform-container"},this.renderBody()))}},{key:"renderBody",value:function(){switch(this.state.platform){case"facebook":return i.a.createElement(U,{createPlatform:this.createPlatform.bind(this)});case"instagram":return i.a.createElement(H,{createPlatform:this.createPlatform.bind(this)})}return i.a.createElement("div",{className:"platform-list-container"},i.a.createElement(T.a,{variant:"outlined",onClick:this.selectPlatform.bind(this,"facebook")},"Connect Facebook"),i.a.createElement(T.a,{variant:"outlined",onClick:this.selectPlatform.bind(this,"instagram")},"Connect Instagram"),i.a.createElement(T.a,{variant:"outlined",disabled:!0,onClick:this.selectPlatform.bind(this,"twitter")},"Connect Twitter"),i.a.createElement(T.a,{variant:"outlined",disabled:!0,onClick:this.selectPlatform.bind(this,"youtube")},"Connect YouTube"))}}]),t}(n.Component),Y=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={platforms:[]},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){}},{key:"updatePlatform",value:function(e,t,a){var n=this;j.getInstance().core.updatePlatform(this.props.platform.id,t,JSON.stringify(a)).then(function(e){return n.props.change()})}},{key:"reauthenticate",value:function(){this.setState({reauthenticate:!0})}},{key:"removePlatform",value:function(){var e=this;j.getInstance().core.deletePlatform(this.props.platform.id).then(function(t){return e.props.change()})}},{key:"render",value:function(){switch(this.state.reauthenticate&&this.props.platform.platform_type){case"facebook":return i.a.createElement(U,{createPlatform:this.updatePlatform.bind(this)});case"instagram":return i.a.createElement(H,{createPlatform:this.updatePlatform.bind(this)})}return i.a.createElement("div",{class:"platform-list-container"},i.a.createElement(T.a,{variant:"outlined",onClick:this.reauthenticate.bind(this)},"Re-Authenticate"),i.a.createElement(T.a,{variant:"outlined",onClick:this.removePlatform.bind(this)},"Remove"))}}]),t}(n.Component),G=a(13),J=a(136),Z=a.n(J),Q=a(134),$=a.n(Q),K=a(137),ee=a.n(K),te=a(135),ae=a.n(te),ne=a(22),ie=a.n(ne),re=a(18),se=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={platforms:[]},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.reload()}},{key:"reload",value:function(){var e=this;j.getInstance().core.loadPlatforms().then(function(t){return e.setState({platforms:t})})}},{key:"renderPlatform",value:function(e){return i.a.createElement($.a,null,i.a.createElement(ae.a,{expandIcon:i.a.createElement(Z.a,null)},i.a.createElement(ie.a,{className:this.props.classes.heading},i.a.createElement("div",{class:"icon-container"},i.a.createElement(re.a,{prefix:"fab",icon:e.icon})),e.name)),i.a.createElement(ee.a,null,i.a.createElement(Y,{platform:e,change:this.reload.bind(this)})))}},{key:"renderNew",value:function(){return i.a.createElement($.a,null,i.a.createElement(ae.a,{expandIcon:i.a.createElement(Z.a,null)},i.a.createElement(ie.a,{className:this.props.classes.heading},"Add New")),i.a.createElement(ee.a,null,i.a.createElement(q,{embedded:!0,change:this.reload.bind(this)})))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"fullpage home one-page"},i.a.createElement("div",{className:"platform-menu-selector"},this.state.platforms.map(function(t){return e.renderPlatform(t)}),i.a.createElement(I.a,null),this.renderNew()))}}]),t}(n.Component),oe=Object(G.withStyles)(function(e){return{heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular}}})(se),le=a(54),ce=a.n(le),ue=a(24),he=a.n(ue),de=a(25),me=a.n(de),pe=a(55),ve=a.n(pe),fe=a(56),ge=a(66),ye=a.n(ge),be=a(182),ke={slider:{color:"#C00",width:"50px",float:"right",padding:"22px 0px"}},we=function(){function e(t){Object(o.a)(this,e),this.timeline=t,this.canvasContext=t.canvasContext}return Object(l.a)(e,[{key:"getX",value:function(){return-1}},{key:"getCanvasX",value:function(){var e=this.getCanvasState();return(this.getX()-e.viewportStart)*e.unitMap/e.unit}},{key:"canDrag",value:function(e){return!1}},{key:"isHit",value:function(e){return!1}},{key:"startDrag",value:function(e){this.dragging=!0}},{key:"mouseMove",value:function(e){var t=this.getCanvasState(),a=(this.getCanvasX(),t.cursorPosition);if(e[0]>this.timeline.canvasWidth-20){var n=1-(this.timeline.canvasWidth-e[0])/20;return[t.realViewportStart+n,this.applyBounds(a)]}if(e[0]<20){var i=e[0]/20;return[t.realViewportStart-i,this.applyBounds(a)]}var r=e[0]*t.unit/t.unitMap+t.viewportStart;return[null,r=this.applyBounds(r)]}},{key:"applyBounds",value:function(e){return Math.max(Math.min(e,this.timeline.end),this.timeline.start)}},{key:"setPositionAndUpdate",value:function(e){}},{key:"stopDrag",value:function(e){this.dragging=!1;var t=this.getCanvasState(),a=e[0]*t.unit/t.unitMap+t.viewportStart;a=this.applyBounds(a),this.setPositionAndUpdate(a)}},{key:"getCanvasState",value:function(){return this.timeline.getCanvasState()}},{key:"draw",value:function(){}}]),e}(),Ee=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"getX",value:function(){return this.getCanvasState().cursorPosition}},{key:"isHit",value:function(e){var t=this.getCanvasX();return!(e[1]<=28||e[1]>40)&&(e[0]>t-10&&e[0]<t+10||void 0)}},{key:"mouseMove",value:function(e){var a=this,n=Object(v.a)(Object(u.a)(t.prototype),"mouseMove",this).call(this,e);null==n[0]?this.timeline.setState({cursorPosition:n[1]},function(){return a.timeline.sendOnChange()}):this.timeline.setState({viewportStart:n[0],cursorPosition:n[1]},function(){return a.timeline.sendOnChange()})}},{key:"setPositionAndUpdate",value:function(e){var t=this;this.timeline.setState({cursorPosition:e},function(){return t.timeline.sendOnChange()})}},{key:"stopDrag",value:function(e){this.dragging=!1;var t=this.getCanvasState(),a=e[0]*t.unit/t.unitMap+t.viewportStart;a=Math.max(Math.min(a,this.timeline.end),this.timeline.start),this.setPositionAndUpdate(a)}},{key:"draw",value:function(){var e=this.getCanvasState(),t=(e.cursorPosition-e.viewportStart)*e.unitMap/e.unit;this.timeline.canvasContext.strokeStyle="#EEE",this.timeline.canvasContext.fillStyle="#EEE",this.timeline.drawLine(t,30,t,99),this.timeline.canvasContext.fillRect(t-7.5,28,15,12)}}]),t}(we),Se=function(e){function t(e,a){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).type=a,n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"getX",value:function(){return this.timeline.props[this.getDirectionPropLabel()]}},{key:"mouseMove",value:function(e){var a=this,n=Object(v.a)(Object(u.a)(t.prototype),"mouseMove",this).call(this,e);null!=n[0]&&this.timeline.setState({viewportStart:n[0]},function(){return a.timeline.sendOnChange()}),this.setPositionAndUpdate(n[1])}},{key:"setPositionAndUpdate",value:function(e){var t=this.timeline.props["start"==this.getDirection()?"onSegmentStart":"onSegmentEnd"];t&&t(e)}},{key:"getDirection",value:function(){return this.type}},{key:"getDirectionPropLabel",value:function(){return"start"==this.type?"segmentStart":"segmentEnd"}},{key:"draw",value:function(){var e=this.getCanvasState();e.cursorPosition,e.viewportStart,e.unitMap,e.unit;this.timeline.canvasContext.strokeStyle="#EEE",this.timeline.canvasContext.fillStyle="#EEE","start"==this.getDirection()?this.drawStart():this.drawEnd()}},{key:"drawStart",value:function(){this.timeline.canvasContext.fillStyle="rgba(220, 0, 0, 0.9)",this.timeline.canvasContext.fillRect(this.getCanvasX()-5,40,5,40),this.timeline.canvasContext.fillRect(this.getCanvasX()-10,50,8,20)}},{key:"drawEnd",value:function(){this.timeline.canvasContext.fillStyle="rgba(220, 0, 0, 0.9)",this.timeline.canvasContext.fillRect(this.getCanvasX(),40,5,40),this.timeline.canvasContext.fillRect(this.getCanvasX()+2,50,8,20)}},{key:"isHit",value:function(e){this.getCanvasX();if(e[1]<50||e[1]>70)return!1;var t=this.getCanvasX();return"start"==this.getDirection()&&e[0]>t-10&&e[0]<t-2||("end"==this.getDirection()&&e[0]>t+2&&e[0]<t+10||void 0)}}]),t}(we),Oe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={cursorPosition:60,zoom:8,viewportStart:0},a.dragging=null,a.playhead=new Ee(Object(fe.a)(Object(fe.a)(a))),a.segments={start:new Se(Object(fe.a)(Object(fe.a)(a)),"start"),end:new Se(Object(fe.a)(Object(fe.a)(a)),"end")},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){if(this.start=e.start,this.end=e.end,this.state.zoom!=t.zoom)return!0;if(!this.draggingTimeline&&!this.dragging&&this.props.offset!=e.offset){var a=this.getCanvasState();return this.props.autoUpdateViewport&&(e.offset<a.viewportStart||e.offset>a.viewportStart+a.viewportWidth)&&(t.viewportStart=e.offset-a.viewportWidth/3),this.setState({cursorPosition:e.offset,viewportStart:t.viewportStart}),!0}return this.state.viewportStart!=t.viewportStart||(this.rerender(),!1)}},{key:"componentWillMount",value:function(){this.start=this.props.start,this.end=this.props.end,this.setState({cursorPosition:this.props.offset||this.props.initialOffset,viewportStart:this.props.offset||this.props.initialOffset}),this.resizeCanvasLocalised=this.resizeCanvas.bind(this),window.addEventListener("resize",this.resizeCanvasLocalised)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizeCanvasLocalised)}},{key:"setCanvas",value:function(e){this.canvas||(this.canvas=e,this.resizeCanvas(),this.canvasContext=e.getContext("2d"),this.drawFullGrid(),this.drawPlayhead())}},{key:"componentDidUpdate",value:function(){this.drawFullGrid()}},{key:"resizeCanvas",value:function(){var e=window.devicePixelRatio||1;this.canvas.width=this.canvas.offsetWidth*e,this.canvas.height=this.canvas.offsetHeight*e,this.canvas.getContext("2d").scale(e,e),this.canvasWidth=this.canvas.offsetWidth}},{key:"getZoom",value:function(e){this.state.zoom;return e<2?[50*e+10,1800,6]:e<4?[50*(e-2)+100,600,10]:e<6?[50*(e-4)+100,300,10]:e<9?[25*(e-6)+100,60,10]:[25*(e-6)+100,30,60]}},{key:"getCanvasState",value:function(){var e=this.getZoom(this.state.zoom),t=e[0],a=e[1],n=e[2];return{unitMap:t,unit:a,offset:0,cursorPosition:this.state.cursorPosition,steps:n,viewportStart:this.state.viewportStart-2,realViewportStart:this.state.viewportStart,viewportWidth:this.canvasWidth/t*a}}},{key:"drawFullGrid",value:function(){this.end,this.start;this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height);var e=this.getCanvasState();this.drawLine(0,40,this.canvas.width,40);for(var t=Math.ceil(e.viewportWidth+e.viewportStart),a=Math.floor(e.viewportStart);a<t;a++){var n=(a-e.viewportStart+this.props.clipDelay)*e.unitMap/e.unit,i=a,r=a%e.unit==0;if(a%(e.unit/e.steps)==0&&(this.canvasContext.strokeStyle=r?"#CCC":"rgba(255, 255, 255, 0.3)",this.drawLine(n,80,n,r?30:37)),r){var s=this.timecode(i);this.drawText(n,15,s[0]),this.drawText(n,30,s[1])}}this.saveCanvas(),this.drawPlayhead()}},{key:"saveCanvas",value:function(){this.canvasState=this.canvasContext.getImageData(0,0,this.canvas.width,this.canvas.height)}},{key:"restoreCanvas",value:function(){this.canvasContext.putImageData(this.canvasState,0,0)}},{key:"recenter",value:function(){var e=this.getCanvasState();!this.draggingTimeline&&e.cursorPosition>e.viewportStart+e.viewportWidth&&this.setState({viewportStart:this.props.offset-e.viewportWidth/3})}},{key:"rerender",value:function(){if(this.canvasContext){var e=this.getCanvasState();if(!this.draggingTimeline&&this.props.autoUpdateViewport&&e.cursorPosition>e.viewportStart+e.viewportWidth)return this.setState({viewportStart:e.cursorPosition-2}),this.fullRender();this.fastRender()}}},{key:"fullRender",value:function(){this.drawFullGrid()}},{key:"fastRender",value:function(){this.restoreCanvas(),this.drawSegments(),this.drawPlayhead()}},{key:"drawPlayhead",value:function(){this.playhead.draw()}},{key:"drawSegments",value:function(){this.drawSegment({start:this.props.segmentStart,end:this.props.segmentEnd}),this.segments.start.draw(),this.segments.end.draw()}},{key:"drawSegment",value:function(e){var t=this.getCanvasState(),a=(e.start-t.viewportStart)*t.unitMap/t.unit,n=(e.end-t.viewportStart)*t.unitMap/t.unit;a>this.canvasWidth+40||n<-40||(this.canvasContext.strokeStyle="rgba(200, 0, 0, 0.4)",this.canvasContext.fillStyle="rgba(200, 0, 0, 0.7)",this.canvasContext.fillRect(a,40,n-a,40))}},{key:"drawLine",value:function(e,t,a,n){this.canvasContext.beginPath(),this.canvasContext.moveTo(e,t),this.canvasContext.lineTo(a,n),this.canvasContext.stroke()}},{key:"drawText",value:function(e,t,a){this.canvasContext.textAlign="center",this.canvasContext.textBaseline="bottom",this.canvasContext.fillStyle="#FFF",this.canvasContext.fillText(a,e,t)}},{key:"getMousePosition",value:function(e){var t=this.canvas.getBoundingClientRect();return[e.clientX-t.left,e.clientY-t.top]}},{key:"draggingPlayhead",value:function(){return this.dragging==this.playhead}},{key:"mouseDown",value:function(e){var t=this.getCanvasState(),a=this.getMousePosition(e);this.playhead.isHit(a)?this.dragging=this.playhead:this.segments.start.isHit(a)?this.dragging=this.segments.start:this.segments.end.isHit(a)&&(this.dragging=this.segments.end);t.cursorPosition,t.viewportStart,t.unitMap,t.unit;a[1]>=40||(this.draggingStartX=a[0],this.draggingViewportStart=this.state.viewportStart,this.draggingTimeline=!0,this.hasMovedTimeline=!1,this.playhead.isHit(a)?(this.draggingTimeline=!1,this.dragging=this.playhead,this.playhead.startDrag()):this.segments.start.isHit(a)&&!this.props.readOnly?(this.draggingTimeline=!1,this.dragging=this.segments.start,this.segments.start.startDrag()):this.segments.end.isHit(a)&&!this.props.readOnly&&(this.draggingTimeline=!1,this.dragging=this.segments.end,this.segments.end.startDrag()))}},{key:"mouseMove",value:function(e){var t=this,a=this.getCanvasState(),n=this.getMousePosition(e);if(this.draggingTimeline){var i=(this.draggingStartX-n[0])*a.unit/a.unitMap;return 0!=i&&(this.hasMovedTimeline=!0),void this.setState({viewportStart:this.draggingViewportStart+i},function(){t.rerender()})}if(this.dragging)this.dragging.mouseMove(n)}},{key:"mouseUp",value:function(e){this.getCanvasState();var t=this.getMousePosition(e);if(this.dragging||this.hasMovedTimeline)if(this.draggingTimeline)this.draggingTimeline=!1;else{var a=this.dragging;this.dragging=null,a&&a.stopDrag(t)}else{if(this.draggingTimeline=!1,t[1]<=28||t[1]>=40)return;this.playhead.stopDrag(t)}}},{key:"sendOnChange",value:function(){this.props.onChange&&this.props.onChange(this.state.cursorPosition)}},{key:"timecode",value:function(e){var t=ye.a.unix(e).local();return[t.format("DD/MM/YYYY"),t.format("HH:mm:ss")]}},{key:"setZoom",value:function(e){var t=this,a=this.getCanvasState(),n=(a.cursorPosition-a.viewportStart)*a.unitMap/a.unit,i=this.getZoom(e),r=i[0],s=i[1],o=a.cursorPosition-n*s/r;this.setState({zoom:e,viewportStart:o},function(){return t.fullRender()})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{style:{textAlign:"right"}},i.a.createElement("div",{style:ke.slider},i.a.createElement(be.Slider,{color:ke.slider.color,value:this.state.zoom,min:1,max:10,onChange:function(t){return e.setZoom(t)}})),i.a.createElement("canvas",{className:"timeline-canvas",ref:function(t){return e.setCanvas(t)},onMouseDown:this.mouseDown.bind(this),onMouseMove:this.mouseMove.bind(this),onMouseUp:this.mouseUp.bind(this)}))}}]),t}(n.Component),Ce=a(79),je=a.n(Ce),Pe=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={loading:!0,timecodeBase:0,discontinuity:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.src!=t.src||this.props.src!=e.src}},{key:"componentWillMount",value:function(){this.setSRC(),this.props.hls&&(this.hls=new je.a({enableWorker:!1,maxBufferHole:10}),this.registerEvents())}},{key:"componentDidUpdate",value:function(e){this.props.src==e.src&&this.props.hls==this.props.hls||this.setSRC()}},{key:"registerEvents",value:function(){var e=this;this.hls.on(je.a.Events.MANIFEST_PARSED,function(){e.setState({loading:!1,discontinuity:!1})}),this.hls.on(je.a.Events.ERROR,function(e,t){console.warn("HLS error",e,t)}),this.hls.on(je.a.Events.LEVEL_LOADED,function(e,t){t.details.fragments[0].programDateTime,t.details.fragments[0].start}),this.hls.on(je.a.Events.FRAG_CHANGED,function(t,a){e.currentFrag=a.frag,console.log("CHANGE IN FRAG",a);var n=a.frag.programDateTime-1e3*a.frag.start;console.log("discont?",n),console.log("found discontinuity",n),e.setState({timecodeBase:n,discontinuity:!0})})}},{key:"getTimecode",value:function(){return this.state.timecodeBase&&this.video?this.state.timecodeBase/1e3+this.video.currentTime:0}},{key:"setTimecode",value:function(e){return e<this.state.timecodeBase/1e3?(console.error("Tried to seek to timecode that isn't loaded"),!1):(this.video.currentTime=e-this.state.timecodeBase/1e3,!0)}},{key:"getEdgeTimecode",value:function(){return this.state.timecodeBase/1e3+this.hls.liveSyncPosition}},{key:"setSRC",value:function(){var e=this;this.setState({src:this.props.hls?"":this.props.src,hls:this.props.hls},function(){e.forceUpdate(),e.state.hls&&e.loadHLS()})}},{key:"loadHLS",value:function(){this.video||(this.pendingLoadHLS=!0),console.error("HLS NOT IMPLEMENTED YET"),this.hls.loadSource(this.props.src),this.hls.attachMedia(this.video)}},{key:"setVideo",value:function(e){this.video||(this.video=e,this.pendingLoadHLS&&(this.pendingLoadHLS=!1,this.loadHLS()))}},{key:"play",value:function(){this.video.play()}},{key:"pause",value:function(){this.video.pause()}},{key:"getFrameRate",value:function(){return 25}},{key:"stepBackwards",value:function(){var e=this.getFrameRate();this.video.currentTime-=1/e}},{key:"stepForwards",value:function(){var e=this.getFrameRate();this.video.currentTime+=1/e}},{key:"seekStart",value:function(){this.setTimecode(this.props.segmentStart)}},{key:"seekEnd",value:function(){this.setTimecode(this.props.segmentEnd)}},{key:"onVideoStateChange",value:function(e){var t=this,a=e.target,n=!(!this.state.hls&&"canplay"==e.type)&&this.state.loading;this.setState({loading:n,videoState:{playing:!a.paused&&!a.ended&&!n&&a.currentTime>=0}},function(){return t.props.onStateChange&&t.props.onStateChange(t.state.videoState)})}},{key:"render",value:function(){var e=this,t=Object.assign({},this.props);return t.src=this.state.src,i.a.createElement("video",Object.assign({ref:function(t){return e.setVideo(t)},onPlay:this.onVideoStateChange.bind(this),onCanPlay:this.onVideoStateChange.bind(this),onPause:this.onVideoStateChange.bind(this),onEnded:this.onVideoStateChange.bind(this)},t))}}]),t}(n.Component),_e=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){}},{key:"playPause",value:function(){this.props.videoState.playing?this.props.video.pause():this.props.video.play()}},{key:"seekStart",value:function(){this.props.video.seekStart()}},{key:"seekEnd",value:function(){this.props.video.seekEnd()}},{key:"stepBackwards",value:function(){this.props.video.stepBackwards()}},{key:"stepForwards",value:function(){this.props.video.stepForwards()}},{key:"render",value:function(){return i.a.createElement("div",{className:"video-controls"},i.a.createElement("div",{className:"video-controls-toolbar "},i.a.createElement(T.a,{variant:"outlined",color:"white",onClick:this.playPause.bind(this)},i.a.createElement(re.a,{icon:this.props.videoState.playing?"pause":"play"}))),i.a.createElement("div",{className:"video-controls-toolbar flex-right"},i.a.createElement(T.a,{variant:"outlined",color:"white",onClick:this.seekStart.bind(this)},i.a.createElement("b",null,"{")," ",i.a.createElement(re.a,{icon:"long-arrow-alt-left"})),i.a.createElement(T.a,{variant:"outlined",color:"white",onClick:this.stepBackwards.bind(this)},i.a.createElement(re.a,{icon:"step-backward"})),i.a.createElement(T.a,{variant:"outlined",color:"white",onClick:this.stepForwards.bind(this)},i.a.createElement(re.a,{icon:"step-forward"})),i.a.createElement(T.a,{variant:"outlined",color:"white",onClick:this.seekEnd.bind(this)},i.a.createElement(re.a,{icon:"long-arrow-alt-right"})," ",i.a.createElement("b",null,"}"))))}}]),t}(n.Component),Te=a(53),xe=a.n(Te),Ie=a(138),Fe=a.n(Ie),Ne=a(183),Ve=a.n(Ne),De=a(42),We=a.n(De),Re=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).themeConfig={text:{line1:{x:function(e){return e["layers.logo"]?350:512},y:155,w:function(e){return e["layers.logo"]?600:915},h:125,maxFont:80,wrap:{minFont:40},textAlign:function(e){return e["layers.logo"]?"start":"middle"},textBaseline:"middle"},line2:{x:512,y:900,w:915,h:175,maxFont:70,wrap:{minFont:40},textAlign:"center",textBaseline:"middle"}}},a.canva={},a.state={line1:"",line2:"","layers.logo":!0,"layers.background":!1,"layers.foreground":!0,video:{playing:!1}},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){try{var e=JSON.parse(this.props.initialState);delete e.raw,this.setState(e)}catch(t){}}},{key:"setLayer",value:function(e,t){if(!this.canva[t])if(this.canva[t]=e,e.width=e.height=1024,"text"!=t){var a=new Image;a.onload=function(){e.getContext("2d").drawImage(a,0,0,1024,1024)},a.src="/frames/demo/"+t+".png"}else this.rerender()}},{key:"clearText",value:function(){var e=this.canva.text;e.getContext("2d").clearRect(0,0,e.width,e.height)}},{key:"evaluateConfig",value:function(e){var t=Object.assign({},e);for(var a in t)"function"==typeof t[a]&&(t[a]=t[a](this.state));return t}},{key:"drawText",value:function(e,t){e=this.evaluateConfig(e);var a=this.canva.text.getContext("2d");a.fillStyle="white",a.textAlign=e.textAlign,a.textBaseline=e.textBaseline;var n=e.maxFont;if(0!=e.wrap){var i=0,r=t.split(" ");if(-1==t.indexOf("^")){for(;;){if(a.font="bold "+n+"px Bebas Neue",n-=5,a.measureText(t).width<=e.w)return void a.fillText(t,e.x,e.y);if(n<=e.wrap.minFont)break}for(i=r.length;i>0;i--){var s=r.slice(0,i).join(" ");if(a.measureText(s).width<e.w)break}}else i=1,r=t.split("^");n=e.wrap.minFont,a.font="bold "+n+"px Bebas Neue",a.fillText(r.slice(0,i).join(" "),e.x,e.y-.7*n),a.fillText(r.slice(i,r.length).join(" "),e.x,e.y+.7*n)}else{do{a.font="bold "+n+"px Bebas Neue",n-=5}while(a.measureText(t).width>e.w);a.fillText(t,e.x,e.y)}}},{key:"onValueChange",value:function(e,t,a){var n=this,i="checkbox"==a.target.type?a.target.checked:a.target.value;null!=t&&(i=t(i)),this.setState(Object(P.a)({},e,i),function(){return n.rerender()})}},{key:"rerender",value:function(){this.clearText(),this.drawText(this.themeConfig.text.line1,this.state.line1),this.drawText(this.themeConfig.text.line2,this.state.line2)}},{key:"getStyleForLayer",value:function(e){return"undefined"!=typeof this.state["layers."+e]?this.state["layers."+e]?{}:{display:"none"}:{}}},{key:"exportData",value:function(){var e=this.mergeLayers(["background"],"#000000"),t=this.mergeLayers(["text","logo","foreground"]),a={line1:this.state.line1,line2:this.state.line2,"layers.logo":this.state["layers.logo"],"layers.background":this.state["layers.background"],"layers.foreground":this.state["layers.foreground"],raw:{background:e,foreground:t}};return JSON.stringify(a)}},{key:"mergeLayers",value:function(e,t){var a=document.createElement("canvas");a.width=a.height=this.canva[e[0]].width;var n=a.getContext("2d");void 0!=t&&(n.fillStyle=t,n.fillRect(0,0,a.width,a.height));for(var i=0;i<e.length;i++)n.drawImage(this.canva[e[i]],0,0);return a.toDataURL()}},{key:"setVideo",value:function(e){if(this.video)return!1;this.video=e,this.forceUpdate()}},{key:"setVideoState",value:function(e){this.setState({video:e})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{class:"fullpage"},i.a.createElement("div",{class:"video-container"},i.a.createElement("div",{class:"video-preview-square"},i.a.createElement("canvas",{ref:function(t){return e.setLayer(t,"background")},className:"layer-0",style:this.getStyleForLayer("background")}),i.a.createElement("div",{className:this.state["layers.background"]?"layer-1 video-layer":"layer-1 video-layer video-layer-stretch"},i.a.createElement(Pe,{ref:function(t){return e.setVideo(t)},hls:!0,src:this.props.previewSRC,style:this.getStyleForLayer("video"),onStateChange:function(t){return e.setVideoState(t)},segmentStart:0,segmentEnd:10})),i.a.createElement("canvas",{ref:function(t){return e.setLayer(t,"text")},className:"layer-2",style:this.getStyleForLayer("text")}),i.a.createElement("canvas",{ref:function(t){return e.setLayer(t,"logo")},className:"layer-3",style:this.getStyleForLayer("logo")}),i.a.createElement("canvas",{ref:function(t){return e.setLayer(t,"foreground")},className:"layer-4",style:this.getStyleForLayer("foreground")})),i.a.createElement(_e,{video:this.video,videoState:this.state.video})),i.a.createElement("div",{class:"video-side"},i.a.createElement("div",{class:"video-selector"},i.a.createElement(ce.a,{position:"static"},i.a.createElement(ve.a,null,i.a.createElement("div",{style:{flex:1}},this.props.coreImportObj.title))),i.a.createElement("div",{class:"side-content"},i.a.createElement(We.a,{control:i.a.createElement(xe.a,{checked:!0,value:"checkedC"}),label:"Enable Frame"}),i.a.createElement("br",null),i.a.createElement(We.a,{control:i.a.createElement(xe.a,{checked:this.state["layers.logo"],onChange:this.onValueChange.bind(this,"layers.logo",null),value:"true"}),label:"Show Logo"}),i.a.createElement("h2",{class:"side-title"},"Text Settings"),i.a.createElement(me.a,{value:this.state.line1,onChange:this.onValueChange.bind(this,"line1",null),label:"Show Title Text (Top Line)",style:{width:"100%"}}),i.a.createElement(me.a,{value:this.state.line2,onChange:this.onValueChange.bind(this,"line2",null),label:"Segment Title Text (Bottom Line)",style:{width:"100%"}}),i.a.createElement("h2",{class:"side-title"},"Frame Settings"),i.a.createElement(We.a,{control:i.a.createElement(xe.a,{checked:this.state["layers.foreground"],onChange:this.onValueChange.bind(this,"layers.foreground",null),value:"true"}),label:"Foreground Graphics"}),i.a.createElement(T.a,{color:"secondary"},"Browse"),i.a.createElement("p",{class:"label-hint"},"(Check me to enable the graphics in the theme that can overlap the video)"),i.a.createElement(Ve.a,{onChange:this.onValueChange.bind(this,"layers.background",function(e){return"true"==e}),value:this.state["layers.background"]},i.a.createElement(We.a,{control:i.a.createElement(Fe.a,{color:"primary"}),label:i.a.createElement("div",null,"Background Graphic\xa0\xa0",i.a.createElement(T.a,{color:"secondary"},"Browse")),value:!0}),i.a.createElement("p",{class:"label-hint"}),i.a.createElement(We.a,{control:i.a.createElement(Fe.a,{color:"primary"}),label:"Fit To Screen",value:!1})),i.a.createElement(T.a,{variant:"contained",color:"secondary",fullWidth:!0,onClick:this.props.saveAndClose.bind(this,this.exportData.bind(this)),className:"padded-button"},"Save & Return")))))}}]),t}(n.Component),Me=Object(G.withStyles)(function(e){return{button:{margin:e.spacing.unit}}})(Re),Be=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"video-thumbnail-video"},i.a.createElement(T.a,{variant:"outlined",onClick:this.props.onClick},i.a.createElement("div",null,i.a.createElement("img",{src:this.props.thumbnail}),i.a.createElement("p",null,this.props.title))))}}]),t}(n.Component),Ae=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"video-thumbnail-container"},this.props.children)}}]),t}(n.Component),Le=a(28),Ue=a.n(Le),He=a(32),ze=a.n(He),Xe=a(33),qe=a.n(Xe),Ye=a(34),Ge=a.n(Ye),Je=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){}},{key:"playPause",value:function(){this.props.videoState.playing?this.props.video.pause():this.props.video.play()}},{key:"seekStart",value:function(){}},{key:"seekEnd",value:function(){}},{key:"stepBackwards",value:function(){this.props.video.stepBackwards()}},{key:"stepForwards",value:function(){this.props.video.stepForwards()}},{key:"format",value:function(e){return e}},{key:"timecode",value:function(e){return[ye.a.unix(e).local().format("DD/MM/YYYY HH:mm:ss.SSS Z")]}},{key:"setBackwards",value:function(){this.triggerOnChange(this.props.value-1/this.props.video.getFrameRate())}},{key:"setForwards",value:function(){this.triggerOnChange(this.props.value+1/this.props.video.getFrameRate())}},{key:"setNow",value:function(){this.triggerOnChange(this.props.video.getTimecode())}},{key:"triggerOnChange",value:function(e){console.log("trigger on change",e,this.props.onChange),this.props.onChange&&this.props.onChange(e)}},{key:"render",value:function(){return i.a.createElement("div",{className:"absolute-time-container"},i.a.createElement(me.a,{variant:"outlined",margin:"normal",style:{width:"270px",flex:"1"},InputProps:{classes:{input:this.props.classes.textField}},label:this.props.label,value:this.timecode(this.props.value-this.props.clipDelay)[0],onChange:function(e){return""}}),i.a.createElement("div",{class:"absolute-time-button-array"},i.a.createElement(T.a,{onClick:this.setBackwards.bind(this),variant:"outlined",color:"white",size:"small",className:this.props.classes.topRowButton},i.a.createElement(re.a,{icon:"step-backward"})),i.a.createElement(T.a,{onClick:this.setNow.bind(this),variant:"outlined",color:"white",size:"small",className:this.props.classes.topRowButton},i.a.createElement(re.a,{icon:"stopwatch"})),i.a.createElement(T.a,{onClick:this.setForwards.bind(this),variant:"outlined",color:"white",size:"small",className:this.props.classes.topRowButton},i.a.createElement(re.a,{icon:"step-forward"}))))}}]),t}(n.Component),Ze=Object(G.withStyles)({textField:{fontSize:"10pt"},topRowButton:{minWidth:"30px"}})(Je),Qe=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={cuePoint:"1.0",name:"",file:null,uploading:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"handleClose",value:function(){this.props.onClose(void 0)}},{key:"handleSelect",value:function(e){this.props.onClose(e)}},{key:"handleSelect",value:function(e){var t=this;isNaN(parseFloat(this.state.cuePoint))||!this.state.file||this.state.name.length<4||(this.setState({uploading:!0}),j.getInstance().core.uploadSlate(this.state.name,this.state.file,parseFloat(this.state.cuePoint)).then(function(e){return t.props.onClose(e)}))}},{key:"selectFile",value:function(e){this.setState({file:e})}},{key:"setData",value:function(e,t){this.setState(Object(P.a)({},e,t.target.value))}},{key:"render",value:function(){var e=this;return i.a.createElement(Ue.a,{open:!0,scroll:"paper"},i.a.createElement(ze.a,null,"Upload New Video"),i.a.createElement(qe.a,null,i.a.createElement(me.a,{label:"Name",onChange:this.setData.bind(this,"name"),value:this.state.name,type:"text"}),i.a.createElement("br",null),i.a.createElement("input",{type:"file",onChange:function(t){return e.selectFile(t.target.files[0])}}),i.a.createElement("br",null),i.a.createElement(me.a,{label:"Cue Point",onChange:this.setData.bind(this,"cuePoint"),value:this.state.cuePoint,type:"text",placeholder:"0.00",mask:"[0-9]+(\\.[0-9]{1,2})?"})),i.a.createElement(Ge.a,null,i.a.createElement(T.a,{onClick:this.handleClose.bind(this),disabled:this.state.uploading,color:"secondary"},"Cancel"),i.a.createElement(T.a,{onClick:this.handleSelect.bind(this),disabled:this.state.uploading,color:"secondary",autoFocus:!0},"Upload")))}}]),t}(n.Component),$e=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={dialog:"",slates:[]},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.loadSlates()}},{key:"loadSlates",value:function(){var e=this;j.getInstance().core.loadSlates().then(function(t){return e.setState({slates:t})})}},{key:"handleClose",value:function(){this.props.onClose(void 0)}},{key:"handleSelect",value:function(e){this.props.onClose(e)}},{key:"openNew",value:function(){this.setState({dialog:"new"})}},{key:"closeSlateView",value:function(e){this.props.onClose(e)}},{key:"render",value:function(){var e=this;return i.a.createElement(Ue.a,{open:!0,maxWidth:"xl",scroll:"paper"},i.a.createElement(ze.a,null,"Select Video"),"new"==this.state.dialog&&i.a.createElement(Qe,{onClose:this.closeSlateView.bind(this)}),i.a.createElement(qe.a,null,i.a.createElement(Ae,null,this.state.slates.map(function(t){return i.a.createElement(Be,{thumbnail:t.getThumbnailPath(),title:t.name,onClick:e.handleSelect.bind(e,t)})}),i.a.createElement("div",{className:"video-thumbnail-video"},i.a.createElement(T.a,{variant:"outlined",onClick:this.openNew.bind(this)},i.a.createElement(re.a,{icon:"plus"}))))),i.a.createElement(Ge.a,null,i.a.createElement(T.a,{onClick:this.handleClose.bind(this),color:"secondary"},"Cancel")))}}]),t}(n.Component),Ke=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={intro_slate_id:null,outro_slate_id:null,intro_slate_name:"None",outro_slate_name:"None",dialog:null,videoSRC:"/slates/default/intro.mp4",video:{playing:!1}},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){try{var e=JSON.parse(this.props.initialState);delete e.raw,this.setState(e)}catch(t){}}},{key:"onValueChange",value:function(e,t,a){var n=this,i="checkbox"==a.target.type?a.target.checked:a.target.value;null!=t&&(i=t(i)),this.setState(Object(P.a)({},e,i),function(){return n.rerender()})}},{key:"exportData",value:function(){var e={intro_slate_id:this.state.intro_slate_id,outro_slate_id:this.state.outro_slate_id,intro_slate_name:this.state.intro_slate_name,outro_slate_name:this.state.outro_slate_name};return JSON.stringify(e)}},{key:"setVideo",value:function(e){if(this.video)return!1;this.video=e,this.forceUpdate()}},{key:"setVideoState",value:function(e){this.setState({video:e})}},{key:"preview",value:function(e){var t=this,a=this.state[e+"_slate_id"];this.setState({videoSRC:"/api/slates/"+a+"/download.mp4"},function(){return t.video.play()})}},{key:"selectSlate",value:function(e){this.setState({dialog:"video_selector",dialogArg:e})}},{key:"closeSlateView",value:function(e){var t;void 0!=e&&this.setState((t={},Object(P.a)(t,this.state.dialogArg+"_slate_id",e.id),Object(P.a)(t,this.state.dialogArg+"_slate_name",e.name),t));this.setState({dialog:null})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"fullpage"},i.a.createElement("div",{className:"video-container"},i.a.createElement("div",{className:"video-player fit"},i.a.createElement("div",{className:"video-player-video-element"},i.a.createElement(Pe,{ref:function(t){return e.setVideo(t)},onStateChange:function(t){return e.setVideoState(t)},hls:!1,src:this.state.videoSRC,segmentStart:0,segmentEnd:999999999}))),i.a.createElement(_e,{video:this.video,videoState:this.state.video})),i.a.createElement("div",{class:"video-side"},i.a.createElement("div",{class:"video-selector"},i.a.createElement(ce.a,{position:"static"},i.a.createElement(ve.a,null,i.a.createElement("div",{style:{flex:1}},this.props.coreImportObj.title))),i.a.createElement("div",{class:"side-content"},i.a.createElement(We.a,{control:i.a.createElement(xe.a,{checked:!0,value:"checkedC"}),label:"Enable Intro & Outro"}),i.a.createElement("h2",{class:"side-title"},"Intro Video"),i.a.createElement("div",{style:{display:"flex"}},i.a.createElement(L.a,{open:!1,onOpen:this.selectSlate.bind(this,"intro"),fullWidth:!0,value:0},i.a.createElement(R.a,{value:0},this.state.intro_slate_name)),i.a.createElement(T.a,{onClick:this.preview.bind(this,"intro")},"Preview")),i.a.createElement("h2",{class:"side-title"},"Outro Video"),i.a.createElement("div",{style:{display:"flex"}},i.a.createElement(L.a,{open:!1,onOpen:this.selectSlate.bind(this,"outro"),fullWidth:!0,value:0},i.a.createElement(R.a,{value:0},this.state.outro_slate_name)),i.a.createElement(T.a,{onClick:this.preview.bind(this,"outro")},"Preview")),i.a.createElement(T.a,{variant:"contained",color:"secondary",fullWidth:!0,onClick:this.props.saveAndClose.bind(this,this.exportData.bind(this)),className:"padded-button"},"Save & Return"),"video_selector"==this.state.dialog&&i.a.createElement($e,{type:this.state.dialogArg,onClose:this.closeSlateView.bind(this)})))))}}]),t}(n.Component),et=Object(G.withStyles)(function(e){return{button:{margin:e.spacing.unit}}})(Ke),tt=a(133),at=a.n(tt),nt=a(132),it=a.n(nt),rt=a(111),st=a.n(rt),ot=a(77),lt=a.n(ot),ct=a(60),ut=a.n(ct),ht=a(61),dt=a.n(ht),mt=a(129),pt=a.n(mt),vt=a(184),ft=a(36),gt=a.n(ft),yt=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={title:"",description:"",visibility:"public"},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this.props.share;void 0!=e&&this.setState(Object(vt.a)({title:e.title,description:e.description},e.configuration))}},{key:"handleClose",value:function(){this.props.saveAndClose(void 0)}},{key:"handleSave",value:function(){this.props.saveAndClose({title:this.state.title,description:this.state.description,configuration:JSON.stringify(this.state),immediate:this.props.immediate})}},{key:"updateLocalField",value:function(e,t){this.setState(Object(P.a)({},e,t.target[t.target.hasOwnProperty("checked")?"checked":"value"]))}},{key:"renderWindow",value:function(){return i.a.createElement("div",{className:"form-container"})}},{key:"wordCount",value:function(e,t){var a="string"==typeof e?e.length:0;return i.a.createElement(gt.a,{className:"form-helper"},a+"/"+t)}},{key:"render",value:function(){return i.a.createElement(Ue.a,{open:!0,maxWidth:"xl",fullWidth:!0,scroll:"paper"},i.a.createElement(ze.a,null,this.platformName),i.a.createElement(qe.a,null,this.renderWindow()),i.a.createElement(Ge.a,null,i.a.createElement(T.a,{onClick:this.handleClose.bind(this),color:"secondary"},"Cancel"),i.a.createElement(T.a,{onClick:this.handleSave.bind(this),color:"secondary",autofocus:!0},this.props.immediate?"Share Now":"Save")))}}]),t}(n.Component),bt=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).platformName="Facebook",a.state={title:"",description:"",visibility:"public"},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"renderWindow",value:function(){return i.a.createElement("div",{className:"form-container"},i.a.createElement("div",{className:"form-column"},i.a.createElement(me.a,{fullWidth:!0,variant:"outlined",helperText:this.wordCount(this.state.title,100),rows:2,rowsMax:2,onChange:this.updateLocalField.bind(this,"title"),value:this.state.title,label:"Video Title (Optional)"}),i.a.createElement(me.a,{multiline:!0,fullWidth:!0,variant:"outlined",helperText:this.wordCount(this.state.description,5e3),rows:10,rowsMax:10,onChange:this.updateLocalField.bind(this,"description"),value:this.state.description,label:"Post Content"})))}}]),t}(yt),kt=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).platformName="YouTube",a.state={title:"",description:"",visibility:"public"},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"renderWindow",value:function(){return i.a.createElement("div",{className:"form-container"},i.a.createElement("div",{className:"form-column"},i.a.createElement(me.a,{fullWidth:!0,variant:"outlined",helperText:this.wordCount(this.state.title,100),rows:2,rowsMax:2,onChange:this.updateLocalField.bind(this,"title"),value:this.state.title,label:"Title"}),i.a.createElement(me.a,{multiline:!0,fullWidth:!0,variant:"outlined",helperText:this.wordCount(this.state.description,5e3),rows:10,rowsMax:10,onChange:this.updateLocalField.bind(this,"description"),value:this.state.description,label:"Video Description"})),i.a.createElement("div",{className:"form-column"},i.a.createElement(B.a,{variant:"outlined",fullWidth:!0},i.a.createElement(L.a,{fullWidth:!0,value:this.state.visibility,variant:"outlined",onChange:this.updateLocalField.bind(this,"visibility"),input:i.a.createElement(N.a,{fullWidth:!0})},i.a.createElement(R.a,{value:"public"},"Public"),i.a.createElement(R.a,{value:"unlisted"},"Unlisted"),i.a.createElement(R.a,{value:"private"},"Private")))))}}]),t}(yt),wt=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).platformName="Twitter",a.state={title:"",description:"",visibility:"public"},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"renderWindow",value:function(){return i.a.createElement("div",{className:"form-container"},i.a.createElement("div",{className:"form-column"},i.a.createElement(me.a,{multiline:!0,fullWidth:!0,variant:"outlined",helperText:this.wordCount(this.state.tweet,280),rows:2,rowsMax:10,onChange:this.updateLocalField.bind(this,"tweet"),value:this.state.tweet,label:"Tweet"})))}}]),t}(yt),Et=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).platformName="Instagram",a.state={title:"",description:"",visibility:"public"},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"renderWindow",value:function(){return i.a.createElement("div",{className:"form-container"},i.a.createElement("div",{className:"form-column"},i.a.createElement(me.a,{multiline:!0,fullWidth:!0,variant:"outlined",helperText:this.wordCount(this.state.description,2200),rows:2,rowsMax:10,onChange:this.updateLocalField.bind(this,"description"),value:this.state.description,label:"Caption"})))}}]),t}(yt),St=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={platformConfig:{},share:{}},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this.props.videoType,t=Object.entries(this.props.enabledProviders).map(function(t){return t[1][e]?t[0]:null});t=t.filter(function(e){return null!=e}),this.setState({enabledProviders:t})}},{key:"getStyle",value:function(){var e=["selectionCardContainer"],t=this.props.video;return null!=t&&(t.queued||t.rendered)&&(e.push("rendering"),e.push("render-state-"+this.getRenderStateClass(t.id))),e.join(" ")}},{key:"getRenderStateClass",value:function(e){var t=this.props.renderState;return t?t.status:"none"}},{key:"getRenderProgressPC",value:function(){var e=this.props.renderState;return e?e.level:0}},{key:"renderRenderProgress",value:function(e){var t=this.props.renderState,a=this.props.video;return null==a||!a.queued&&!a.rendered?null:i.a.createElement("div",{className:"rendering-progress"},i.a.createElement("div",{className:"rendering-progress-element",style:{width:this.getRenderProgressPC()+"%"}}),i.a.createElement("p",null,t?t.state:"N/A"))}},{key:"reset",value:function(){window.confirm("Really delete this rendered video?")&&this.props.updateState({target:{value:!1}})}},{key:"renderPostOptions",value:function(){var e=this,t=this.props.videoType;return i.a.createElement("div",null,i.a.createElement(st.a,null,i.a.createElement("div",{class:"title-with-action-button"},i.a.createElement(ie.a,{variant:"h5",component:"h2"},this.props.description),i.a.createElement(he.a,{onClick:this.props.downloadVideo.bind(this,t)},i.a.createElement(re.a,{icon:"download",className:"small-icon"})),i.a.createElement(he.a,{onClick:this.reset.bind(this)},i.a.createElement(re.a,{icon:"trash",className:"small-icon"}))),i.a.createElement("p",null,"Send To Platforms"),i.a.createElement(pt.a,{fullWidth:!0,className:"platform-menu-list"},this.getPlatforms().map(function(t){return i.a.createElement(R.a,{onClick:e.configurePlatform.bind(e,t)},i.a.createElement(ut.a,null,i.a.createElement(re.a,{prefix:"fab",icon:t.icon})),i.a.createElement(dt.a,{primary:t.name}))}))))}},{key:"findShareForPlatform",value:function(e){var t=this.props.video;return t?t.shares.find(function(t){return t.platform.id==e.id}):null}},{key:"updatePlatform",value:function(e,t){if(!this.isPlatformEnabled(e)&&t.target.checked)return this.configurePlatform(e);var a=this.props.videoType;this.props.updatePlatform(e,a,t.target.checked)}},{key:"configurePlatform",value:function(e){this.openSubView(e.platform_type,this.findShareForPlatform(e),e)}},{key:"saveConfiguration",value:function(e,t){var a=this.props.videoType;this.props.updatePlatform(e,a,!0,t)}},{key:"openSubView",value:function(e,t,a){this.setState({subview:e,subviewArgument:t,subviewState:a})}},{key:"closeSubView",value:function(e,t){void 0!=t&&this.saveConfiguration(this.state.subviewState,t),this.setState({subview:null})}},{key:"getPlatforms",value:function(){var e=this;return this.props.platforms.filter(function(t){return e.state.enabledProviders.indexOf(t.platform_type)>-1})}},{key:"isPlatformEnabled",value:function(e){if(this.props.video){for(var t in this.props.video.shares){if(this.props.video.shares[t].platform.id==e)return!0}return!1}}},{key:"isVideoReady",value:function(){var e=this.props.renderState,t=this.props.video;return e&&"completed"==e.status||t&&1==t.rendered}},{key:"renderBody",value:function(){var e=this;this.props.videoType;return this.isVideoReady()?this.renderPostOptions():i.a.createElement("div",{className:"selectionCard"},this.renderRenderProgress(),i.a.createElement(it.a,null,i.a.createElement(xe.a,{checked:this.props.enabled,onChange:this.props.updateState.bind(this),color:"primary"})),i.a.createElement(st.a,null,i.a.createElement(ie.a,{variant:"h5",component:"h2"},this.props.description,"\xa0\xa0",i.a.createElement(T.a,{disabled:!this.props.enabled,onClick:this.props.openSubView.bind(this)},"Edit")),i.a.createElement("p",null,"Select platforms to share on"),i.a.createElement(lt.a,null,this.getPlatforms().map(function(t){return i.a.createElement(We.a,{control:i.a.createElement(xe.a,{disabled:!e.props.enabled,checked:e.isPlatformEnabled(t.id),onChange:e.updatePlatform.bind(e,t)}),label:i.a.createElement("div",null,i.a.createElement(re.a,{icon:t.icon}),"\xa0\xa0",t.name,"\xa0\xa0",i.a.createElement(he.a,{disabled:!e.props.enabled,onClick:e.configurePlatform.bind(e,t)},i.a.createElement(re.a,{icon:"pencil-alt",className:"small-icon"})))})}))))}},{key:"render",value:function(){return i.a.createElement(at.a,{className:this.getStyle()},this.renderDialog(),this.renderBody())}},{key:"renderDialog",value:function(){var e={share:this.state.subviewArgument,saveAndClose:this.closeSubView.bind(this,this.state.subview),immediate:this.isVideoReady()};switch(this.state.subview){case"youtube":return i.a.createElement(kt,e);case"facebook":return i.a.createElement(bt,e);case"twitter":return i.a.createElement(wt,e);case"instagram":return i.a.createElement(Et,e);default:return null}}}]),t}(n.Component),Ot=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).clipDelay=1.7,a.state={importObj:null,currentTime:0,lastSaveTime:0,video:{playing:!1},slate:!1,frame:!1,videoTitle:null,platforms:{},platformState:{},subview:null,renderState:[]},a.providers={youtube:{slate:!0,frame:!1},facebook:{slate:!0,frame:!0},twitter:{slate:!0,frame:!0},instagram:{slate:!1,frame:!0}},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.loadImport(),this.loadRenderState(),this.loadPlatforms(),this.interval=setInterval(function(){e.video&&0!=e.video.getTimecode()&&(e.video.getTimecode()>=e.state.importObj.end_time&&(e.video.pause(),e.video.seekStart()),e.setState({currentTime:e.video.getTimecode()}))},100)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"getServiceName",value:function(){return"video"}},{key:"getImportID",value:function(){return this.props.match.params.id}},{key:"loadImport",value:function(){var e=this,t=j.getInstance();t.ingest.findImportByID(this.getServiceName(),this.getImportID()).then(function(t){e.setState({importObj:t})}),t.core.findImportByID(this.getImportID()).then(function(t){e.setState({coreImportObj:t,videoTitle:t.title},function(){return e.checkForVideos()})}).catch(function(a){console.log("error finding",a),t.core.takeOwnership(e.getServiceName(),e.getImportID(),e.state.videoTitle).then(function(t){e.setState({coreImportObj:t},function(){return e.checkForVideos()})})})}},{key:"loadPlatforms",value:function(){var e=this;j.getInstance().core.loadPlatforms().then(function(t){return e.setState({platforms:t})})}},{key:"loadRenderState",value:function(){var e=this;j.getInstance().core.loadRenderState(this.getImportID()).then(function(t){e.setState({renderState:t}),t.length>0&&setTimeout(e.loadRenderState.bind(e),5e3)})}},{key:"checkForVideos",value:function(){for(var e=this.state.coreImportObj.videos,t={},a=0;a<e.length;a++)t[e[a].type]=!0;this.setState(t)}},{key:"getEnabledVideoTypes",value:function(){var e=this;return["default","slate","frame"].filter(function(t){return 1==e.state[t]})}},{key:"checkAndCreateVideos",value:function(){for(var e=this,t=this.getEnabledVideoTypes(),a=this.state.coreImportObj.videos,n=j.getInstance(),i=0;i<a.length;i++)t.includes(a[i].type)?t=t.filter(function(e){return e!=a[i].type}):n.core.deleteVideoById(this.getImportID(),a[i].id).then(function(t){e.setState({coreImportObj:t})});for(i=0;i<t.length;i++)n.core.createVideoByType(this.getImportID(),t[i]).then(function(t){return e.setState({coreImportObj:t})})}},{key:"findVideoForType",value:function(e){return this.state.coreImportObj.videos.find(function(t){return t.type==e})}},{key:"updatePlatform",value:function(e,t,a,n){var i=this,r=this.findShareForPlatformAndType(e,t),s=this.findVideoForType(t),o=j.getInstance();r?a?o.core.updateShare(this.getImportID(),s.id,r.id,n.title,n.description,n.configuration).then(function(e){return i.setState({coreImportObj:e})}).then(function(){return n.immediate&&i.publishShare(s,r)}):o.core.deleteShare(this.getImportID(),s.id,r.id).then(function(e){return i.setState({coreImportObj:e})}):a&&o.core.createShare(this.getImportID(),s.id,e.id,n.title,n.description,n.configuration).then(function(e){return i.setState({coreImportObj:e})})}},{key:"publishShare",value:function(e,t){var a=j.getInstance();console.log("Publishing share",t),a.core.publishShare(this.getImportID(),e.id,t.id).then(function(e){return console.log(e)})}},{key:"findShareForPlatformAndType",value:function(e,t){var a=this.findVideoForType(t);return a?a.shares.find(function(t){return t.platform.id==e.id}):null}},{key:"onTimelineUpdate",value:function(e){this.video.setTimecode(e)}},{key:"setVideo",value:function(e){this.video=e}},{key:"setVideoState",value:function(e){this.setState({video:e})}},{key:"getVideoSRC",value:function(){return this.state.importObj.getPreviewPath()}},{key:"updateLocalField",value:function(e,t,a){var n=this;this.setState(Object(P.a)({},e,t.target[t.target.hasOwnProperty("checked")?"checked":"value"]),function(){return"function"==typeof a&&a()||n.checkAndCreateVideos()})}},{key:"updateLocalFieldAndSave",value:function(e,t){var a=this;this.updateLocalField(e,t,function(){return a.rateLimitSave(),a.checkAndCreateVideos()})}},{key:"openSubView",value:function(e){"/"==this.props.location.pathname.substr(-1,1)?this.props.history.replace(this.props.location.pathname+e):this.props.history.replace(this.props.location.pathname+"/"+e)}},{key:"closeSubView",value:function(e,t){if(void 0!=t){var a=t();this.saveConfiguration(e,a)}this.props.history.replace(this.props.location.pathname+"/..")}},{key:"rateLimitSave",value:function(){this.saveTimer||(this.saveTimer=setTimeout(this.save.bind(this),500))}},{key:"save",value:function(){this.saveTimer=null,j.getInstance().core.takeOwnership(this.getServiceName(),this.getImportID(),this.state.videoTitle)}},{key:"sendRender",value:function(){var e=this;this.getEnabledVideoTypes().map(function(t){return e.findVideoForType(t)}).forEach(function(t){return e.sendVideoForRender(t)})}},{key:"sendVideoForRender",value:function(e){var t=this;j.getInstance().core.renderVideo(this.getImportID(),e.id).then(function(e){e.set("title",t.state.videoTitle),t.setState({coreImportObj:t.state.coreImportObj}),t.loadRenderState()})}},{key:"downloadRawVideo",value:function(){window.open(this.state.importObj.getPreviewPath(),"_blank")}},{key:"downloadVideo",value:function(e){window.open(this.findVideoForType(e).getDownloadPath(),"_blank")}},{key:"saveConfiguration",value:function(e,t){var a=this,n=j.getInstance(),i=this.findVideoForType(e).id;n.core.updateVideo(this.getImportID(),i,t).then(function(e){a.setState({coreImportObj:e})})}},{key:"getRenderState",value:function(e){var t=this.findVideoForType(e);return t?this.state.renderState.find(function(e){return e.video_id==t.id}):null}},{key:"handleClose",value:function(){this.props.history.push("/imports")}},{key:"deleteClip",value:function(){if(window.confirm("Really delete video clip?")){var e=j.getInstance();e.core.deleteImport(this.getServiceName(),this.getImportID()).then(function(e){console.log("Deletion core?",e)}),e.ingest.deleteImportByID(this.getServiceName(),this.getImportID()).then(function(e){console.log("Deletion ingest?",e)})}}},{key:"render",value:function(){var e=this;if(!this.state.importObj||!this.state.coreImportObj)return i.a.createElement("b",null,"loading");switch(this.props.location.pathname.split("/").pop()){case"frame":return i.a.createElement(Me,{importObj:this.state.importObj,coreImportObj:this.state.coreImportObj,previewSRC:this.getVideoSRC(),initialState:this.findVideoForType("frame").configuration,saveAndClose:this.closeSubView.bind(this,"frame")});case"slate":return i.a.createElement(et,{importObj:this.state.importObj,coreImportObj:this.state.coreImportObj,previewSRC:this.getVideoSRC(),initialState:this.findVideoForType("slate").configuration,saveAndClose:this.closeSubView.bind(this,"slate")})}return i.a.createElement("div",{className:"fullpage"},i.a.createElement("div",{className:"video-container"},i.a.createElement("div",{className:"video-player fit"},i.a.createElement("div",{className:"video-player-video-element"},i.a.createElement(Pe,{ref:function(t){return e.setVideo(t)},onStateChange:function(t){return e.setVideoState(t)},hls:!0,src:this.getVideoSRC(),segmentStart:this.state.importObj.start_time,segmentEnd:this.state.importObj.end_time}))),i.a.createElement(_e,{video:this.video,videoState:this.state.video}),i.a.createElement("div",{className:"video-timeline"},i.a.createElement(Oe,{start:this.state.importObj.start_time,end:this.state.importObj.end_time,offset:this.state.currentTime,onChange:this.onTimelineUpdate.bind(this),segmentStart:this.state.importObj.start_time,segmentEnd:this.state.importObj.end_time,clipDelay:this.clipDelay,autoUpdateViewport:!0,readOnly:!0,initialOffset:0}))),i.a.createElement("div",{className:"video-side"},i.a.createElement("div",{className:"video-selector"},i.a.createElement(ce.a,{position:"static"},i.a.createElement(ve.a,null,i.a.createElement("div",{style:{flex:1}},i.a.createElement(me.a,{fullWidth:!0,placeholder:"Untitled",value:this.state.videoTitle,onChange:this.updateLocalFieldAndSave.bind(this,"videoTitle"),margin:"normal"})),i.a.createElement(he.a,{onClick:this.deleteClip.bind(this)},i.a.createElement(re.a,{icon:"trash",size:"sm"})))),i.a.createElement("div",{className:"side-content"},i.a.createElement(ie.a,{variant:"h5",component:"h2"},"Target Platforms"),[["slate","Linear Video"],["frame","Square Video"]].map(function(t){return i.a.createElement(St,{videoType:t[0],description:t[1],platforms:e.state.platforms,enabledProviders:e.providers,enabled:e.state[t[0]],updatePlatform:e.updatePlatform.bind(e),openSubView:e.openSubView.bind(e,t[0]),updateState:e.updateLocalField.bind(e,t[0]),downloadVideo:e.downloadVideo.bind(e,t[0]),renderState:e.getRenderState(t[0]),video:e.findVideoForType(t[0])})}),i.a.createElement(T.a,{variant:"contained",color:"secondary",fullWidth:!0,onClick:this.sendRender.bind(this),className:"padded-button"},"Export & Share"),i.a.createElement("p",{className:"small-text"},"Rendering may take a few minutes and is dependent on available server resources"),i.a.createElement("p",{className:"small-text"},"Video will be immediately shared"),i.a.createElement(T.a,{variant:"contained",color:"primary",fullWidth:!0,onClick:this.downloadRawVideo.bind(this),className:"padded-button"},"Download Raw Video")))))}}]),t}(n.Component),Ct=Object(G.withStyles)(function(e){return{button:{margin:e.spacing.unit}}})(Ot),jt=a(462),Pt=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement(jt.a,{to:"/import"})}}]),t}(n.Component),_t=Object(G.withStyles)(function(e){return{button:{margin:e.spacing.unit}}})(Pt),Tt=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={dialog:"",points:[]},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.loadCuePoints()}},{key:"loadCuePoints",value:function(){var e=this;j.getInstance().ingest.loadCuePoints().then(function(t){return e.setPoints(t)})}},{key:"setPoints",value:function(e){e=e.reverse();for(var t=0;t<e.length;t++)e[t].set("start_time",e[t].start_time+this.props.clipDelay),e[t].set("end_time",e[t].end_time+this.props.clipDelay);this.setState({points:e})}},{key:"handleClose",value:function(){this.props.onClose(void 0)}},{key:"handleSelect",value:function(e){this.props.onClose(e)}},{key:"formatTime",value:function(e){return this.formatHMS(new Date(1e3*e.start_time))+" - "+this.formatHMS(new Date(1e3*e.end_time))}},{key:"formatHMS",value:function(e){return e.toISOString().substr(11,8)}},{key:"render",value:function(){var e=this;return i.a.createElement(Ue.a,{open:!0,maxWidth:"xl",scroll:"paper"},i.a.createElement(ze.a,null,"Select Video"),i.a.createElement(qe.a,null,i.a.createElement(Ae,null,this.state.points.map(function(t){return i.a.createElement(Be,{thumbnail:t.getThumbnailPath(),title:e.formatTime(t),onClick:e.handleSelect.bind(e,t)})}))),i.a.createElement(Ge.a,null,i.a.createElement(T.a,{onClick:this.handleClose.bind(this),color:"secondary"},"Cancel")))}}]),t}(n.Component),xt=a(140),It=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={date:null,time:null},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.setState({date:new Date(this.props.initial),time:new Date(this.props.initial)})}},{key:"change",value:function(e,t){this.setState(Object(P.a)({},e,t))}},{key:"handleClose",value:function(){this.props.onClose(void 0)}},{key:"handleSelect",value:function(){this.props.onClose(this.getTime())}},{key:"getTime",value:function(){var e=new Date(this.state.date.getTime());return e.setHours(this.state.time.getHours()),e.setMinutes(this.state.time.getMinutes()),e.setSeconds(this.state.time.getSeconds()),e.setMilliseconds(this.state.time.getMilliseconds()),e}},{key:"render",value:function(){return i.a.createElement(Ue.a,{open:!0,maxWidth:"xl",scroll:"paper"},i.a.createElement(ze.a,null,"Select Time"),i.a.createElement(qe.a,{style:{minWidth:"300px",minHeight:"300px"}},i.a.createElement(xt.a,{value:this.state.date,onChange:this.change.bind(this,"date")}),i.a.createElement(xt.b,{value:this.state.time,onChange:this.change.bind(this,"time")})),i.a.createElement(Ge.a,null,i.a.createElement(T.a,{onClick:this.handleClose.bind(this),color:"secondary"},"Cancel"),i.a.createElement(T.a,{onClick:this.handleSelect.bind(this),color:"secondary"},"Go")))}}]),t}(n.Component),Ft=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).clipDelay=1.7,a.state={currentTime:0,ready:!1,video:{playing:!1},dialog:null,segmentStart:-1,segmentEnd:-1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=Date.now()/1e3|0;t-=t%3600,this.start=t-18e3,this.interval=setInterval(function(){if(e.video&&0!=e.video.getTimecode()){var t=e.state.ready,a=e.video.getTimecode();Math.abs(a-e.state.currentTime)>5e3&&e.timeline,e.setState({currentTime:a,currentEdge:e.video.getEdgeTimecode(),ready:!0},function(){return t||e.videoLoaded()})}},100)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"getServiceName",value:function(){return"video"}},{key:"videoLoaded",value:function(){this.setState({segmentStart:(Date.now()/1e3|0)-660,segmentEnd:(Date.now()/1e3|0)-60})}},{key:"setVideo",value:function(e){this.video=e}},{key:"onTimelineUpdate",value:function(e){this.video.setTimecode(e)}},{key:"setVideoState",value:function(e){this.setState({video:e})}},{key:"setSegmentStart",value:function(e){console.log("request set segment start",e);var t=this.state.segmentEnd;t<=e&&(t=e+30),this.setState({segmentStart:e,segmentEnd:t})}},{key:"setSegmentEnd",value:function(e){var t=this.state.segmentStart;t>=e&&(t=e-30),this.setState({segmentStart:t,segmentEnd:e})}},{key:"serialize",value:function(){return{name:this.state.name,startTime:this.state.segmentStart,endTime:this.state.segmentEnd}}},{key:"importVideo",value:function(){var e=this.serialize();return j.getInstance().ingest.importVideo(this.getServiceName(),e.startTime,e.endTime)}},{key:"saveForLater",value:function(){this.importVideo().then(function(e){console.log("IMPORT OBJECT",e)})}},{key:"saveAndAdvance",value:function(){var e=this;this.importVideo().then(function(t){console.log("IMPORT OBJECT 2",t),e.props.history.push("/import/"+t.uuid+"/edit")})}},{key:"quickDownload",value:function(){window.open("/api/ingest/"+this.getServiceName()+"/download.mp4?start_time="+(this.state.segmentStart+this.clipDelay)+"&end_time="+(this.state.segmentEnd+this.clipDelay),"_blank")}},{key:"handleClose",value:function(){this.props.history.push("/")}},{key:"selectCuePoint",value:function(e){this.setState({dialog:"cue_point",dialogArg:"cue_point"})}},{key:"selectTime",value:function(e){this.setState({dialog:"time",dialogArg:"time"})}},{key:"closeSlateView",value:function(e){var t=this;void 0!=e&&"cue_point"==this.state.dialog&&this.setState({segmentStart:e.start_time,segmentEnd:e.end_time},function(){t.video.seekStart()}),void 0!=e&&"time"==this.state.dialog&&this.setState({segmentStart:e/1e3|0,segmentEnd:30+(e/1e3|0)},function(){t.video.seekStart()}),this.setState({dialog:null})}},{key:"setTimeline",value:function(e){null==this.timeline&&(this.timeline=e)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"fullpage"},i.a.createElement("div",{className:"video-container"},i.a.createElement("div",{className:"video-player fit"},i.a.createElement("div",{className:"video-player-video-element"},i.a.createElement(Pe,{ref:function(t){return e.setVideo(t)},onStateChange:function(t){return e.setVideoState(t)},hls:!0,src:"/api/ingest/"+this.getServiceName()+"/preview.m3u8?start_time=1545354123&end_time=99999999999",segmentStart:this.state.segmentStart,segmentEnd:this.state.segmentEnd}))),i.a.createElement(_e,{video:this.video,videoState:this.state.video}),i.a.createElement("div",{className:"video-timeline"},i.a.createElement(Oe,{start:this.start,end:this.state.currentEdge,offset:this.state.currentTime,onChange:this.onTimelineUpdate.bind(this),segmentStart:this.state.segmentStart,segmentEnd:this.state.segmentEnd,clipDelay:this.clipDelay,ref:this.setTimeline.bind(this),autoUpdateViewport:!0,onSegmentStart:this.setSegmentStart.bind(this),onSegmentEnd:this.setSegmentEnd.bind(this),initialOffset:0}))),i.a.createElement("div",{className:"video-side"},i.a.createElement("div",{className:"video-selector"},i.a.createElement(ce.a,{position:"static"},i.a.createElement(ve.a,null,i.a.createElement(he.a,{color:"inherit","aria-label":"Save For Later",onClick:this.handleClose.bind(this)},i.a.createElement(re.a,{icon:"long-arrow-alt-left"})),i.a.createElement("div",{style:{flex:1}}))),i.a.createElement("div",{className:"side-content import-wizard"},i.a.createElement("h1",null,"Import Wizard."),i.a.createElement("h3",null,"1. Find Content"),i.a.createElement("div",{class:"row"},i.a.createElement(T.a,{variant:"contained",color:"secondary",fullWidth:!0,onClick:this.selectTime.bind(this)},i.a.createElement(re.a,{icon:"stopwatch"}),"\xa0Search By Time"),i.a.createElement(T.a,{variant:"contained",color:"secondary",fullWidth:!0,onClick:this.selectCuePoint.bind(this)},i.a.createElement(re.a,{icon:"file-video"}),"\xa0Search By Clip")),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement("h3",null,"2. Fine Tune"),i.a.createElement(Ze,{label:"Start",video:this.video,onChange:this.setSegmentStart.bind(this),clipDelay:this.clipDelay,value:this.state.segmentStart}),i.a.createElement(Ze,{label:"End",video:this.video,onChange:this.setSegmentEnd.bind(this),clipDelay:this.clipDelay,value:this.state.segmentEnd}),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement("h3",null,"3. Import"),i.a.createElement("div",{class:"row"},i.a.createElement(T.a,{variant:"contained",color:"primary",fullWidth:!0,className:"padded-button",onClick:this.saveForLater.bind(this)},"Save For Later"),i.a.createElement(T.a,{variant:"contained",color:"primary",fullWidth:!0,className:"padded-button",onClick:this.quickDownload.bind(this)},"Quick Download")),i.a.createElement(T.a,{variant:"contained",color:"secondary",fullWidth:!0,className:"padded-button",onClick:this.saveAndAdvance.bind(this)},"Next: Edit Video")))),"cue_point"==this.state.dialog&&i.a.createElement(Tt,{onClose:this.closeSlateView.bind(this),clipDelay:this.clipDelay}),"time"==this.state.dialog&&i.a.createElement(It,{initial:1e3*this.state.currentTime,onClose:this.closeSlateView.bind(this)}))}}]),t}(n.Component),Nt=Object(G.withStyles)(function(e){return{button:{margin:e.spacing.unit}}})(Ft),Vt=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={imports:[],coreImports:[],queue:2},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.loadImports()}},{key:"getServiceName",value:function(){return"video"}},{key:"loadImports",value:function(){var e=this,t=j.getInstance();t.ingest.findImports(this.getServiceName()).then(function(t){t=t.sort(function(e,t){return e.end_time<t.end_time}),e.setState({imports:t,queue:e.state.queue-1},function(){return e.recoverMissing()})}),t.core.loadImports().then(function(t){e.setState({coreImports:t,queue:e.state.queue-1},function(){return e.recoverMissing()})})}},{key:"findCoreImport",value:function(e){return this.state.coreImports.find(function(t){return t.uuid==e.uuid})||{}}},{key:"recoverMissing",value:function(){var e=this;0==this.state.queue&&this.state.imports.forEach(function(t){e.state.coreImports.find(function(e){return e&&e.uuid==t.uuid})||e.createCoreImport(t)})}},{key:"createCoreImport",value:function(e){var t=this;j.getInstance().core.takeOwnership(e.service_name,e.uuid,"").then(function(e){var a=t.state.coreImports.slice(0);a.push(e),t.setState({coreImports:a})})}},{key:"handleSelect",value:function(e){this.props.history.push("/import/"+e.uuid+"/edit")}},{key:"openNew",value:function(){}},{key:"handleClose",value:function(){this.props.history.push("/")}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{class:"fullpage home imports"},i.a.createElement("div",{class:"main-navigation"},i.a.createElement(Ae,null,this.state.imports.map(function(t){return i.a.createElement(Be,{thumbnail:t.getThumbnailPath(),title:e.findCoreImport(t).title,onClick:e.handleSelect.bind(e,t)})}))))}}]),t}(n.Component),Dt=Object(G.withStyles)(function(e){return{button:{margin:e.spacing.unit}}})(Vt),Wt=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{class:"fullpage home"},"i am loading")}}]),t}(n.Component),Rt=(n.Component,a(461)),Mt=a(9),Bt=a.n(Mt),At=a(189),Lt=a.n(At),Ut=a(130),Ht=a.n(Ut),zt=a(68),Xt=a.n(zt),qt=a(88),Yt=a.n(qt),Gt=a(191),Jt=a.n(Gt),Zt=a(190),Qt=a.n(Zt),$t=a(194),Kt=a.n($t),ea=a(192),ta=a.n(ea),aa=a(193),na=a.n(aa),ia=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={open:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"toggle",value:function(){this.setState({open:!this.state.open},function(){setTimeout(function(){window.dispatchEvent(new Event("resize"))},295)})}},{key:"close",value:function(){this.setState({open:!1},function(){setTimeout(function(){window.dispatchEvent(new Event("resize"))},295)})}},{key:"render",value:function(){var e,t,a=this.props.classes,n=Bt()(a.drawerBase,(e={},Object(P.a)(e,a.drawerOpen,this.state.open),Object(P.a)(e,a.drawerClose,!this.state.open),e)),r=Bt()(a.userBox,Object(P.a)({},a.userBoxVisible,this.state.open)),s=Bt()((t={},Object(P.a)(t,a.hideState,this.state.open),Object(P.a)(t,a.showState,!this.state.open),t));return i.a.createElement(Lt.a,{open:this.state.open,anchor:"left",variant:"permanent",className:n,classes:{paper:n}},i.a.createElement(Ht.a,{className:a.menu},i.a.createElement(Xt.a,{button:!this.state.open,onClick:this.toggle.bind(this)},i.a.createElement(ut.a,null,i.a.createElement(Qt.a,{className:s})),i.a.createElement(dt.a,{primary:""}),i.a.createElement(he.a,null,i.a.createElement(Yt.a,null))),i.a.createElement("div",{className:r},"{ user.name }"),i.a.createElement(I.a,null),i.a.createElement(Xt.a,{component:Rt.a,button:!0,to:"/",onClick:this.close.bind(this)},i.a.createElement(ut.a,null,i.a.createElement(Jt.a,null)),i.a.createElement(dt.a,{primary:"Home"})),i.a.createElement(Xt.a,{component:Rt.a,button:!0,to:"/import",onClick:this.close.bind(this)},i.a.createElement(ut.a,null,i.a.createElement(ta.a,null)),i.a.createElement(dt.a,{primary:"New Import"})),i.a.createElement(Xt.a,{component:Rt.a,button:!0,to:"/imports",onClick:this.close.bind(this)},i.a.createElement(ut.a,null,i.a.createElement(na.a,null)),i.a.createElement(dt.a,{primary:"Import Library"})),i.a.createElement(Xt.a,{component:Rt.a,button:!0,to:"/config",onClick:this.close.bind(this)},i.a.createElement(ut.a,null,i.a.createElement(Kt.a,null)),i.a.createElement(dt.a,{primary:"Platform Settings"}))))}}]),t}(n.Component),ra=Object(G.withStyles)(function(e){var t;return{drawerBase:{width:240,flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{overflowX:"hidden",width:240,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:(t={overflowX:"hidden",width:7*e.spacing.unit+1},Object(P.a)(t,e.breakpoints.up("sm"),{width:8*e.spacing.unit+7}),Object(P.a)(t,"transition",e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})),t),menu:{paddingTop:0},userBox:{height:"0px",overflowY:"hidden",opacity:0,visibility:"hidden",transition:e.transitions.create("height",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},userBoxVisible:{height:"100px",opacity:1,visibility:"visible"},hideState:{opacity:"0",transition:e.transitions.create("opacity",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},showState:{opacity:"1"}}},{withTheme:!0})(ia),sa=a(87),oa=a(38),la=a(89);sa.b.add(oa.g,oa.e,oa.c,oa.d,oa.j,oa.k,oa.i,oa.h,oa.b,oa.f,oa.m,oa.a,oa.l,la.a,la.c,la.b,la.d);var ca=Object(G.createMuiTheme)({palette:{type:"dark"}}),ua=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={ready:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this;j.getInstance().bootstrap().then(function(t){e.setState({ready:!0})})}},{key:"render",value:function(){return this.state.ready?i.a.createElement(m.a,null,i.a.createElement(G.MuiThemeProvider,{theme:ca},i.a.createElement("div",{className:"page-master"},i.a.createElement("div",{className:"page-container"},i.a.createElement(ra,null),i.a.createElement("div",{className:"page-outlet"},i.a.createElement(d.a,{exact:!0,path:"/",component:_t}),i.a.createElement(d.a,{exact:!0,path:"/import",component:Nt}),i.a.createElement(d.a,{exact:!0,path:"/imports",component:Dt}),i.a.createElement(d.a,{path:"/import/:id/edit",component:Ct}),i.a.createElement(d.a,{exact:!0,path:"/config",component:oe}),i.a.createElement(d.a,{path:"/config/platform/:id",component:Y}),i.a.createElement(d.a,{exact:!0,path:"/config/platform/new",component:q})))))):i.a.createElement(Wt,null)}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(ua,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[196,2,1]]]);
//# sourceMappingURL=main.bbec3133.chunk.js.map